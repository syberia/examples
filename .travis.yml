language: r
cache: packages
sudo: false
r:
    - oldrel
    - release
    - devel
repos:
  CRAN: https://cloud.r-project.org
env:
  - global:
    - R_LIBS_USER=~/.R/library
r_github_packages:
    - syberia/mungebits2
    - syberia/stagerunner
    - syberia/tundra
    - syberia/director
    - syberia/syberia

cache:
  directories:
    ~/.R
before_script:
    - rm -rf "/home/travis/.R/.syberia"
    - mkdir -p "$R_LIBS_USER"
script: Rscript -e 'library(syberia); library(methods); devtools::with_options(list(stub
  = 1), force); syberia::syberia_engine(); quit(status = tryCatch({ syberia::test_engine();
  0 }, error = function(e) { message(e); message(bettertrace::stacktrace()); 1 }));'

notifications:
  email:
    on_success: change
    on_failure: change
